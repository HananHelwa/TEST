var http = require("http");
var Common = require('./Common');
var ShiftsToAssignees = require('./ShiftsToAssignees');
var config = require('config');

//get configs 
var adminEmail = config.get('Brand.adminEmail');
var adminPassword = config.get('Brand.adminPassword');
var brandID = config.get('Brand.id');
var roleID = config.get('ScheduleShifts.EmployeesRoleID');
var ScheduleID = config.get('ScheduleShifts.ScheduleID');
var host = config.get('ScheduleShifts.APIHostName');
var assignees = [2961323,2961324,2961325,2961330,2961331,2961332,2961411,2961412,2961413,2961414,2961415,2961416,2961417,2961418,2961419,2961420,2961421,2961422,2961423,2961424,2961425,2961426,2961427,2961428,2961429,2961430,2961431,2961432,2961433,2961434,2961435,2961436,2961437,2961438,2961439,2961440,2961441,2961442,2961443,2961444,2961445,2961446,2961447,2961448,2961449,2961450,2961451,2961452,2961453,2961454,2961455,2961456,2961457,2961458,2961459,2961460,2961461,2961462,2961463,2961464,2961465,2961466,2961467,2961468,2961469,2961470,2961471,2961472,2961473,2961474,2961475,2961476,2961477,2961478,2961479,2961480,2961481,2961482,2961483,2961484,2961485,2961486,2961487,2961488,2961489,2961490,2961491,2961492,2961493,2961494,2961495,2961496,2961497,2961498,2961499,2961500,2961501,2961502,2961503,2961504,2961505,2961506,2961507,2961508,2961509,2961510,2961511,2961512,2961513,2961514,2961515,2961516,2961517,2961518,2961519,2961520,2961521,2961522,2961523,2961524,2961525,2961526,2961527,2961528,2961529,2961530,2961531,2961532,2961533,2961534,2961535,2961536,2961537,2961538,2961539,2961540,2961541,2961542,2961543,2961544,2961545,2961546,2961547,2961548,2961549,2961550,2961551,2961552,2961553,2961554,2961555,2961556,2961557,2961558,2961559,2961560,2961561,2961562,2961563,2961564,2961565,2961566,2961567,2961568,2961569,2961570,2961571,2961572,2961573,2961574,2961575,2961576,2961577,2961578,2961579,2961580,2961581,2961582,2961583,2961584,2961585,2961586,2961587,2961588,2961589,2961590,2961591,2961592,2961593,2961594,2961595,2961596,2961597,2961598,2961599,2961600,2961601,2961602,2961603,2961604,2961605,2961606,2961607,2961608,2961609,2961610,2961611,2961612,2961613,2961614,2961615,2961616,2961617,2961618,2961619,2961620,2961621,2961622,2961623,2961624,2961625,2961626,2961627,2961628,2961629,2961630,2961631,2961632,2961633,2961634,2961635,2961636,2961637,2961638,2961639,2961640,2961641,2961642,2961643,2961644,2961645,2961646,2961647,2961648,2961649,2961650,2961651,2961652,2961653,2961654,2961655,2961656,2961657,2961658,2961659,2961660,2961661,2961662,2961663,2961664,2961665,2961666,2961667,2961668,2961669,2961670,2961671,2961672,2961673,2961674,2961675,2961676,2961677,2961678,2961679,2961680,2961681,2961682,2961683,2961684,2961685,2961686,2961687,2961688,2961689,2961690,2961691,2961692,2961693,2961694,2961695,2961696,2961697,2961698,2961699,2961700,2961701,2961702,2961703,2961704,2961705,2961706,2961707,2961708,2961709,2961710,2961711,2961712,2961713,2961714,2961715,2961716,2961717,2961718,2961719,2961720,2961721,2961722,2961723,2961724,2961725,2961726,2961727,2961728,2961729,2961730,2961731,2961732,2961733,2961734,2961735,2961736,2961737,2961738,2961739,2961740,2961741,2961742,2961743,2961744,2961745,2961746,2961747,2961748,2961749,2961750,2961751,2961752,2961753,2961754,2961755,2961756,2961757,2961758,2961759,2961760,2961761,2961762,2961763,2961764,2961765,2961766,2961767,2961768,2961769,2961770,2961771,2961772,2961773,2961774,2961775,2961776,2961777,2961778,2961779,2961780,2961781,2961782,2961783,2961784,2961785,2961786,2961787,2961788,2961789,2961790,2961791,2961792,2961793,2961794,2961795,2961796,2961797,2961798,2961799,2961800,2961801,2961802,2961803,2961804,2961805,2961806,2961807,2961808,2961809,2961810,2961811,2961812,2961813,2961814,2961815,2961816,2961817,2961818,2961819,2961820,2961821,2961822,2961823,2961824,2961825,2961826,2961827,2961828,2961829,2961830,2961831,2961832,2961833,2961834,2961835,2961836,2961837,2961838,2961839,2961840,2961841,2961842,2961843,2961844,2961845,2961846,2961847,2961848,2961849,2961850,2961851,2961852,2961853,2961854,2961855,2961856,2961857,2961858,2961859,2961860,2961861,2961862,2961863,2961864,2961865,2961866,2961867,2961868,2961869,2961870,2961871,2961872,2961873,2961874,2961875,2961876,2961877,2961878,2961879,2961880,2961881,2961882,2961883,2961884,2961885,2961886,2961887,2961888,2961889,2961890,2961891,2961892,2961893,2961894,2961895,2961896,2961897,2961898,2961899,2961900,2961901,2961902,2961903,2961904,2961905,2961906,2961907,2961908,2961909,2961910,2961911,2961912,2961913,2961914,2961915,2961916,2961917,2961918,2961919,2961920,2961921,2961922,2961923,2961924,2961925,2961926,2961927,2961928,2961929,2961930,2961931,2961932,2961933,2961934,2961935];

var options = {
  "method": "PUT",
  "hostname": config.get('Environment.host'),
  "port": null,
  "path": config.get('Environment.loginAPI'),
  "headers": {
    "content-type": "application/json;charset=UTF-8",
  }
};


var req = http.request(options, function (res) {
  var chunks = [];

  res.on("data", function (chunk) {
    chunks.push(chunk);
  });

  res.on("end", function () {
    var body = Buffer.concat(chunks);
    if (res.statusCode == 200) {
      console.log("Admin logged in successfully");
      // display returned cookies in header
      var setcookie = res.headers["set-cookie"];
      RequestAPI(setcookie);
    
    } else {
      console.log(body.toString());
    }

  });
});

req.write("{\"username\":\"" + adminEmail + "\",\"password\":\"" + adminPassword + "\"}");
req.end();

function RequestAPI(cookie) {

  for (var i = 0; i <= assignees.length; i++) {
    ShiftsToAssignees.add(brandID, assignees[i], ScheduleID, roleID, cookie, host);
  }
}
